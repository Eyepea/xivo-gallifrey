## /bin/sh -e simulate dpatch for prepend_chlog.py
## Build
## no_misdn_build.dpatch by Marc Dequ-b√®nes (Duck) <mdequenes@proformatique.com>-A
## DP: Disable the build of the chan_misdn that is shipped with the official
## DP: Asterisk tarball from Digium

Index: asterisk-1.2.27/channels/Makefile
===================================================================
--- asterisk-1.2.27.orig/channels/Makefile	2008-03-19 11:33:22.000000000 +0100
+++ asterisk-1.2.27/channels/Makefile	2008-03-19 11:33:49.000000000 +0100
@@ -16,7 +16,7 @@
 
 CHANNEL_LIBS=chan_sip.so chan_agent.so chan_mgcp.so chan_iax2.so chan_local.so chan_skinny.so chan_features.so
 
-SUBDIRS=misdn h323
+SUBDIRS=h323
 
 ifneq (${OSARCH},CYGWIN)
 # if you really, really want to use these drivers, uncomment the line below
@@ -87,14 +87,14 @@
   CHANNEL_LIBS+=chan_h323.so
 endif
 
-ifneq ($(wildcard $(CROSS_COMPILE_TARGET)/usr/include/mISDNuser/mISDNlib.h),)
-  CHANNEL_LIBS+=chan_misdn.so
-  CFLAGS+=-Imisdn  
-endif
-
-ifneq ($(wildcard $(CROSS_COMPILE_TARGET)/usr/include/linux/mISDNdsp.h),)
-  CFLAGS+=-DMISDN_1_2
-endif
+#ifneq ($(wildcard $(CROSS_COMPILE_TARGET)/usr/include/mISDNuser/mISDNlib.h),)
+#  CHANNEL_LIBS+=chan_misdn.so
+#  CFLAGS+=-Imisdn  
+#endif
+
+#ifneq ($(wildcard $(CROSS_COMPILE_TARGET)/usr/include/linux/mISDNdsp.h),)
+#  CFLAGS+=-DMISDN_1_2
+#endif
 
 CFLAGS+=-Wno-missing-prototypes -Wno-missing-declarations
 
@@ -174,9 +174,9 @@
   include h323/Makefile.ast
 endif
 
-ifneq ($(wildcard misdn/Makefile.ast),)
-  include misdn/Makefile.ast
-endif
+#ifneq ($(wildcard misdn/Makefile.ast),)
+#  include misdn/Makefile.ast
+#endif
 
 gentone: gentone.c
 	$(HOST_CC) -o gentone gentone.c -lm
@@ -240,17 +240,17 @@
 	$(CC) $(SOLINK) -o $@ $< h323/libchanh323.a $(CHANH323LIB) -L$(PWLIBDIR)/lib $(PTLIB) -L$(OPENH323DIR)/lib $(H323LIB) -L/usr/lib -lcrypto -lssl -lexpat
 endif
 
-misdn/chan_misdn_lib.a:
-	make CROSS_COMPILE_TARGET=$(CROSS_COMPILE_TARGET) -C misdn
+#misdn/chan_misdn_lib.a:
+#	make CROSS_COMPILE_TARGET=$(CROSS_COMPILE_TARGET) -C misdn
 
-chan_misdn.so: chan_misdn.o misdn_config.o misdn/chan_misdn_lib.a 
-	$(CC) -shared -Xlinker -x -L/usr/lib -o $@ $^ -lisdnnet -lmISDN 
+#chan_misdn.so: chan_misdn.o misdn_config.o misdn/chan_misdn_lib.a 
+#	$(CC) -shared -Xlinker -x -L/usr/lib -o $@ $^ -lisdnnet -lmISDN 
 
-chan_misdn.o: chan_misdn.c 
-	$(CC) $(CFLAGS) -DCHAN_MISDN_VERSION=\"0.3.0\" -c $< -o $@
+#chan_misdn.o: chan_misdn.c 
+#	$(CC) $(CFLAGS) -DCHAN_MISDN_VERSION=\"0.3.0\" -c $< -o $@
 
-misdn_config.o: misdn_config.c misdn/chan_misdn_config.h
-	$(CC) $(CFLAGS) -DCHAN_MISDN_VERSION=\"0.3.0\" -c $< -o $@
+#misdn_config.o: misdn_config.c misdn/chan_misdn_config.h
+#	$(CC) $(CFLAGS) -DCHAN_MISDN_VERSION=\"0.3.0\" -c $< -o $@
 
 #chan_modem.so : chan_modem.o
 #	$(CC) -rdynamic -shared -Xlinker -x -o $@ $<
