
NameVirtualHost *:443

<VirtualHost *:443>
	ServerAdmin technique@proformatique.com
	DocumentRoot /usr/share/pf-xivo-web-interface/www

	ErrorLog /var/log/apache2/xivo_error.log
	CustomLog /var/log/apache2/xivo_access.log combined

	# XXX Snom phones don't work with SSL
	RewriteEngine On
	RewriteCond %{HTTP_USER_AGENT} ^snom3[026]0/.*$
	RewriteRule .* http://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

	SSLEngine on
	SSLOptions +FakeBasicAuth +StrictRequire +StdEnvVars +ExportCertData
	SSLProtocol all
	SSLCipherSuite RSA:!EXP:!NULL:+HIGH:+MEDIUM:-LOW
	SSLCertificateFile /etc/apache2/cert/server.crt
	SSLCertificateKeyFile /etc/apache2/cert/server.key
	SSLCACertificatePath /etc/ssl/certs/
	SSLCACertificateFile /etc/ssl/certs/proformatique.crt
	SSLVerifyClient none

	Include "/usr/share/pf-xivo-web-interface/apache.conf"
</VirtualHost>


NameVirtualHost *:8667

<VirtualHost *:8667>
	DocumentRoot /tftpboot/Snom

	ErrorLog /var/log/apache2/xivo_error_snom.log
	CustomLog /var/log/apache2/xivo_access_snom.log combined

	<Directory />
		Options FollowSymLinks
		AllowOverride None
	</Directory>
</VirtualHost>

NameVirtualHost *:80

<VirtualHost *:80>
	RewriteEngine On

	# XXX Snom phones don't work with SSL
	RewriteCond %{HTTP_USER_AGENT} ^snom3[026]0/.*$
	RewriteRule .* - [L,R=301]

	RewriteCond %{HTTPS} off
	RewriteRule .* https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
</VirtualHost>
