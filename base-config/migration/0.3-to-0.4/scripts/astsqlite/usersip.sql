DELETE FROM tmp_usersip WHERE category = 'user';

INSERT INTO tmp_usersip (
	id,
	name,
	type,
	username,
	secret,
	md5secret,
	context,
	language,
	accountcode,
	amaflags,
	allowtransfer,
	fromuser,
	fromdomain,
	mailbox,
	subscribemwi,
	buggymwi,
	'call-limit',
	callerid,
	fullname,
	cid_number,
	maxcallbitrate,
	insecure,
	nat,
	canreinvite,
	promiscredir,
	usereqphone,
	videosupport,
	trustrpid,
	sendrpid,
	allowsubscribe,
	allowoverlap,
	dtmfmode,
	rfc2833compensate,
	qualify,
	g726nonstandard,
	disallow,
	allow,
	autoframing,
	mohinterpret,
	mohsuggest,
	useclientcode,
	progressinband,
	t38pt_udptl,
	t38pt_rtp,
	t38pt_tcp,
	t38pt_usertpsource,
	rtptimeout,
	rtpholdtimeout,
	rtpkeepalive,
	deny,
	permit,
	defaultip,
	callgroup,
	pickupgroup,
	setvar,
	host,
	port,
	regexten,
	subscribecontext,
	fullcontact,
	vmexten,
	callingpres,
	ipaddr,
	regseconds,
	regserver,
	lastms,
	protocol,
	category,
	commented)
SELECT
	usersip.id,
	usersip.name,
	'friend',
	usersip.username,
	usersip.secret,
	'',
	CASE WHEN usersip.context = 'initconfig' THEN 'xivo-initconfig' ELSE usersip.context END,
	NULL,
	NULLIF(usersip.accountcode,''),
	IFNULL(NULLIF(usersip.amaflags,''),'default'),
	NULL,
	NULLIF(usersip.fromuser,''),
	NULLIF(usersip.fromdomain,''),
	NULLIF(usersip.mailbox,''),
	1,
	0,
	usersip."call-limit",
	usersip.callerid,
	NULL,
	NULL,
	NULL,
	NULLIF(usersip.insecure,''),
	NULLIF(usersip.nat,''),
	NULLIF(usersip.canreinvite,''),
	NULL,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL,
	NULLIF(usersip.dtmfmode,''),
	NULL,
	NULLIF(usersip.qualify,''),
	NULL,
	NULLIF(usersip.disallow,''),
	NULLIF(usersip.allow,''),
	NULL,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL,
	NULLIF(usersip.rtptimeout,''),
	NULLIF(usersip.rtpholdtimeout,''),
	NULL,
	NULLIF(usersip.deny,''),
	NULLIF(usersip.permit,''),
	NULLIF(usersip.defaultip,''),
	NULLIF(usersip.callgroup,''),
	NULLIF(usersip.pickupgroup,''),
	'',
	IFNULL(NULLIF(usersip.host,''),'dynamic'),
	NULLIF(usersip.port,''),
	NULLIF(usersip.regexten,''),
	NULL,
	NULLIF(usersip.fullcontact,''),
	NULL,
	NULL,
	IFNULL(usersip.ipaddr,''),
	IFNULL(usersip.regseconds,0),
	NULL,
	'',
	'sip',
	'user',
	usersip.commented
FROM usersip
WHERE usersip.category = 'user';
